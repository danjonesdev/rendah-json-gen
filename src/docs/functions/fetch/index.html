{% extends '../../_layouts/master.html' %}

{% set title = 'Fetch' %}
{% set bodyClass = 'page-fetch' %}

{% block content %}

  {% include '../../_partials/subnav.html' with { type: 'functions' } %}

  <section class="section  rel  pa5">
    <header class="mb5">
      <h1 class="f5  fw7  lh-title  mb3">
        {{title}}
      </h1>

      <div class="measure-wide  f4  fw3  lh-copy">
        <p class="f3">
          An example of fetching json data from a RESTful API using {% include '../../_partials/code-snippet.html' with { language: 'javascript', body: 'async/await' } %}, in this case Hacker News.
        </p>

        <p>
          {% include '../../_partials/code-snippet.html' with { language: 'javascript', body: 'modules/Example.js' } %} shows the complete workings of the functionality on this page but basically we are calling the async function {% include '../../_partials/code-snippet.html' with { language: 'javascript', body: 'getTopStories()' } %} and awaiting the response, manipulating the data and then rendering on the page.
        </p>

        <p>
          For an added bonus the <a class="link  blue" href="/functions/button">Button</a> component loading state is also set upon user interaction and once the data has been fetched.
        </p>
      </div>
    </header>

    <div class="mw7  mb4">
      <h2 class="f4  fw4  lh-title  mb3">
        Hacker News &mdash; Latest
      </h2>

      <div id="js-fetch-feed"></div>

      <div class="flex  pt4">
        {% include '../../_partials/button.html' with {
          id: 'fetch-posts',
          class: 'btn  rel  pv3  ph4  f5  white  bg-black  bn',
          label: 'Load posts',
          fill: '#fff'
        } %}
      </div>
    </div>

    <div class="mw7">
{% include '../../_partials/preformatted.html' with { language: 'javascript',
body: "import axios from 'axios';

const FetchAsync = async endpoint => {
  try {
    const response = await axios.get(endpoint);
    return response.data;
  } catch (error) {
    console.error(error);
  }
  return false;
};

export default FetchAsync;"
} %}
    </div>
  </section>

{% endblock %}
